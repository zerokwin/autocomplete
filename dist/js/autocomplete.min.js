"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t},AutoComplete=function(window){function wrap(t){var e=document.createElement("div"),o=this.elem.cloneNode(!0);e.id="autocomplete_wrap",e.className="autocomplete_wrap",e.style.position="relative",e.style.width=t.width+"px",e.style.height=t.height+"px",e.appendChild(o),document.body.replaceChild(e,this.elem),this.elem=document.getElementById(this.id)}function calcHeight(t){return parseFloat(window.getComputedStyle(t,null).height)+parseFloat(window.getComputedStyle(t,null).borderTopWidth)+parseFloat(window.getComputedStyle(t,null).borderBottomWidth)+parseFloat(window.getComputedStyle(t,null).paddingTop)+parseFloat(window.getComputedStyle(t,null).paddingBottom)}function calcWidth(t){return console.log(window.getComputedStyle(t,null).width),parseFloat(window.getComputedStyle(t,null).width)+parseFloat(window.getComputedStyle(t,null).borderLeftWidth)+parseFloat(window.getComputedStyle(t,null).borderRightWidth)+parseFloat(window.getComputedStyle(t,null).paddingLeft)+parseFloat(window.getComputedStyle(t,null).paddingRight)}function formatParams(t){var e=[];for(var o in t)e.push(encodeURIComponent(o)+"="+encodeURIComponent(t[o]));return e.push(("v="+Math.random()).replace(".","")),e.join("&")}function getData(t){var e=this;t&&Ajax({url:t,success:function(t){e.opts.src=t}})}function filter(t){var e=[],o=[],n=[];return t?(e=this.opts.src.filter(function(e){return e="object"===e?e.value:e,e.toLowerCase().includes(t)}),e.map(function(e){e="object"===e?e.value:e,e.match(/\d+/)[0].substring(0,t.length)===t?o.push(e):n.push(e)}),e=o.concat(n)):(this.clean(),!1)}function changeListener(t){var e=this;addEventListener(e.elem,"keyup",function(){var t=e.elem.value.toLowerCase();e.index=-1;var o=filter.call(e,t);e.render(o)})}!function(){String.prototype.includes||(String.prototype.includes=function(){return-1!==String.prototype.indexOf.apply(this,arguments)}),Array.prototype.filter||(Array.prototype.filter=function(t){var e=this.length;if("function"!=typeof t)throw new TypeError;for(var o=[],n=arguments[1],r=0;e>r;r++)if(r in this){var i=this[r];t.call(n,i,r,this)&&o.push(i)}return o}),Array.prototype.map||(Array.prototype.map=function(t,e){var o,n,r;if(null==this)throw new TypeError(" this is null or not defined");var i=Object(this),a=i.length>>>0;if("[object Function]"!=Object.prototype.toString.call(t))throw new TypeError(t+" is not a function");for(e&&(o=e),n=new Array(a),r=0;a>r;){var l,s;r in i&&(l=i[r],s=t.call(o,l,r,i),n[r]=s),r++}return n}),window.getComputedStyle||(window.getComputedStyle=function(t){return t.currentStyle})}();var addEventListener=function(){return document.addEventListener?function(t,e,o){t.addEventListener(e,o,!1)}:document.attachEvent?function(t,e,o){t.attachEvent("on"+e,o)}:void 0}(),Ajax=function Ajax(opts){var xhr=null;if("undefined"==typeof XMLHttpRequest)throw new Error("您的浏览器不支持原生XHR，请使用最新版本的浏览器！");xhr=new XMLHttpRequest,opts=opts||{},opts.type=(opts.type||"GET").toUpperCase(),opts.dataType=opts.dataType||"json";var params=formatParams(opts.data);switch(xhr.onreadystatechange=function(){if(4===xhr.readyState){var status=xhr.status;status>=200&&300>status||304===status?opts.success&&opts.success(eval(xhr.responseText)):opts.fail&&opts.fail(status)}},opts.type){case"POST":xhr.open("post",opts.url,!0),xhr.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),xhr.send(params);break;case"GET":xhr.open("get",opts.url+"?"+params,!0),xhr.send(null)}},defaults={src:null,minLength:1,itemLength:8,timeout:100,filter:function(){}},autocomplete=function(t,e,o){this.id=t,this.elem=document.getElementById(this.id),this.url=e||"",this.init(o)};return autocomplete.prototype={init:function(t){if(t)for(var e in t)defaults.hasOwnProperty(e)&&(defaults[e]=t[e]);this.opts=defaults,this.index=-1,this.style={width:calcWidth(this.elem),height:calcHeight(this.elem)},wrap.call(this,this.style),getData.call(this,this.url),changeListener.call(this)},render:function(t){var e=document.createElement("ul"),o=t.length>this.opts.itemLength?this.opts.itemLength:t.length;e.id="autocomplete_list";for(var n=0;o>n;n++){t[n]="object"===_typeof(t[n])?t[n].value:t[n];var r=document.createElement("li"),i=document.createTextNode(t[n]);r.setAttribute("data-item",t[n]),r.appendChild(i),e.appendChild(r)}this.clean(),document.getElementById("autocomplete_wrap").appendChild(e)},clean:function(){document.getElementById("autocomplete_list")&&document.getElementById("autocomplete_wrap").removeChild(document.getElementById("autocomplete_list"))}},autocomplete}(window);